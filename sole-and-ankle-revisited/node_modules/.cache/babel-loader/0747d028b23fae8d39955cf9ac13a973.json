{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.RemoveScrollSideCar = exports.getDeltaXY = exports.getTouchXY = void 0;\n\nvar tslib_1 = require(\"tslib\");\n\nvar React = tslib_1.__importStar(require(\"react\"));\n\nvar react_remove_scroll_bar_1 = require(\"react-remove-scroll-bar\");\n\nvar react_style_singleton_1 = require(\"react-style-singleton\");\n\nvar aggresiveCapture_1 = require(\"./aggresiveCapture\");\n\nvar handleScroll_1 = require(\"./handleScroll\");\n\nvar getTouchXY = function (event) {\n  return 'changedTouches' in event ? [event.changedTouches[0].clientX, event.changedTouches[0].clientY] : [0, 0];\n};\n\nexports.getTouchXY = getTouchXY;\n\nvar getDeltaXY = function (event) {\n  return [event.deltaX, event.deltaY];\n};\n\nexports.getDeltaXY = getDeltaXY;\n\nvar extractRef = function (ref) {\n  return ref && 'current' in ref ? ref.current : ref;\n};\n\nvar deltaCompare = function (x, y) {\n  return x[0] === y[0] && x[1] === y[1];\n};\n\nvar generateStyle = function (id) {\n  return \"\\n  .block-interactivity-\".concat(id, \" {pointer-events: none;}\\n  .allow-interactivity-\").concat(id, \" {pointer-events: all;}\\n\");\n};\n\nvar idCounter = 0;\nvar lockStack = [];\n\nfunction RemoveScrollSideCar(props) {\n  var shouldPreventQueue = React.useRef([]);\n  var touchStartRef = React.useRef([0, 0]);\n  var activeAxis = React.useRef();\n  var id = React.useState(idCounter++)[0];\n  var Style = React.useState(function () {\n    return (0, react_style_singleton_1.styleSingleton)();\n  })[0];\n  var lastProps = React.useRef(props);\n  React.useEffect(function () {\n    lastProps.current = props;\n  }, [props]);\n  React.useEffect(function () {\n    if (props.inert) {\n      document.body.classList.add(\"block-interactivity-\".concat(id));\n\n      var allow_1 = tslib_1.__spreadArray([props.lockRef.current], (props.shards || []).map(extractRef), true).filter(Boolean);\n\n      allow_1.forEach(function (el) {\n        return el.classList.add(\"allow-interactivity-\".concat(id));\n      });\n      return function () {\n        document.body.classList.remove(\"block-interactivity-\".concat(id));\n        allow_1.forEach(function (el) {\n          return el.classList.remove(\"allow-interactivity-\".concat(id));\n        });\n      };\n    }\n\n    return;\n  }, [props.inert, props.lockRef.current, props.shards]);\n  var shouldCancelEvent = React.useCallback(function (event, parent) {\n    if ('touches' in event && event.touches.length === 2) {\n      return !lastProps.current.allowPinchZoom;\n    }\n\n    var touch = (0, exports.getTouchXY)(event);\n    var touchStart = touchStartRef.current;\n    var deltaX = 'deltaX' in event ? event.deltaX : touchStart[0] - touch[0];\n    var deltaY = 'deltaY' in event ? event.deltaY : touchStart[1] - touch[1];\n    var currentAxis;\n    var target = event.target;\n    var moveDirection = Math.abs(deltaX) > Math.abs(deltaY) ? 'h' : 'v'; // allow horizontal touch move on Range inputs. They will not cause any scroll\n\n    if ('touches' in event && moveDirection === 'h' && target.type === 'range') {\n      return false;\n    }\n\n    var canBeScrolledInMainDirection = (0, handleScroll_1.locationCouldBeScrolled)(moveDirection, target);\n\n    if (!canBeScrolledInMainDirection) {\n      return true;\n    }\n\n    if (canBeScrolledInMainDirection) {\n      currentAxis = moveDirection;\n    } else {\n      currentAxis = moveDirection === 'v' ? 'h' : 'v';\n      canBeScrolledInMainDirection = (0, handleScroll_1.locationCouldBeScrolled)(moveDirection, target); // other axis might be not scrollable\n    }\n\n    if (!canBeScrolledInMainDirection) {\n      return false;\n    }\n\n    if (!activeAxis.current && 'changedTouches' in event && (deltaX || deltaY)) {\n      activeAxis.current = currentAxis;\n    }\n\n    if (!currentAxis) {\n      return true;\n    }\n\n    var cancelingAxis = activeAxis.current || currentAxis;\n    return (0, handleScroll_1.handleScroll)(cancelingAxis, parent, event, cancelingAxis === 'h' ? deltaX : deltaY, true);\n  }, []);\n  var shouldPrevent = React.useCallback(function (_event) {\n    var event = _event;\n\n    if (!lockStack.length || lockStack[lockStack.length - 1] !== Style) {\n      // not the last active\n      return;\n    }\n\n    var delta = 'deltaY' in event ? (0, exports.getDeltaXY)(event) : (0, exports.getTouchXY)(event);\n    var sourceEvent = shouldPreventQueue.current.filter(function (e) {\n      return e.name === event.type && e.target === event.target && deltaCompare(e.delta, delta);\n    })[0]; // self event, and should be canceled\n\n    if (sourceEvent && sourceEvent.should) {\n      if (event.cancelable) {\n        event.preventDefault();\n      }\n\n      return;\n    } // outside or shard event\n\n\n    if (!sourceEvent) {\n      var shardNodes = (lastProps.current.shards || []).map(extractRef).filter(Boolean).filter(function (node) {\n        return node.contains(event.target);\n      });\n      var shouldStop = shardNodes.length > 0 ? shouldCancelEvent(event, shardNodes[0]) : !lastProps.current.noIsolation;\n\n      if (shouldStop) {\n        if (event.cancelable) {\n          event.preventDefault();\n        }\n      }\n    }\n  }, []);\n  var shouldCancel = React.useCallback(function (name, delta, target, should) {\n    var event = {\n      name: name,\n      delta: delta,\n      target: target,\n      should: should\n    };\n    shouldPreventQueue.current.push(event);\n    setTimeout(function () {\n      shouldPreventQueue.current = shouldPreventQueue.current.filter(function (e) {\n        return e !== event;\n      });\n    }, 1);\n  }, []);\n  var scrollTouchStart = React.useCallback(function (event) {\n    touchStartRef.current = (0, exports.getTouchXY)(event);\n    activeAxis.current = undefined;\n  }, []);\n  var scrollWheel = React.useCallback(function (event) {\n    shouldCancel(event.type, (0, exports.getDeltaXY)(event), event.target, shouldCancelEvent(event, props.lockRef.current));\n  }, []);\n  var scrollTouchMove = React.useCallback(function (event) {\n    shouldCancel(event.type, (0, exports.getTouchXY)(event), event.target, shouldCancelEvent(event, props.lockRef.current));\n  }, []);\n  React.useEffect(function () {\n    lockStack.push(Style);\n    props.setCallbacks({\n      onScrollCapture: scrollWheel,\n      onWheelCapture: scrollWheel,\n      onTouchMoveCapture: scrollTouchMove\n    });\n    document.addEventListener('wheel', shouldPrevent, aggresiveCapture_1.nonPassive);\n    document.addEventListener('touchmove', shouldPrevent, aggresiveCapture_1.nonPassive);\n    document.addEventListener('touchstart', scrollTouchStart, aggresiveCapture_1.nonPassive);\n    return function () {\n      lockStack = lockStack.filter(function (inst) {\n        return inst !== Style;\n      });\n      document.removeEventListener('wheel', shouldPrevent, aggresiveCapture_1.nonPassive);\n      document.removeEventListener('touchmove', shouldPrevent, aggresiveCapture_1.nonPassive);\n      document.removeEventListener('touchstart', scrollTouchStart, aggresiveCapture_1.nonPassive);\n    };\n  }, []);\n  var removeScrollBar = props.removeScrollBar,\n      inert = props.inert;\n  return React.createElement(React.Fragment, null, inert ? React.createElement(Style, {\n    styles: generateStyle(id)\n  }) : null, removeScrollBar ? React.createElement(react_remove_scroll_bar_1.RemoveScrollBar, {\n    gapMode: \"margin\"\n  }) : null);\n}\n\nexports.RemoveScrollSideCar = RemoveScrollSideCar;","map":{"version":3,"sources":["/Users/pavel/Desktop/Github repos/css-for-js/sole-and-ankle-revisited/node_modules/react-remove-scroll/dist/es5/SideEffect.js"],"names":["Object","defineProperty","exports","value","RemoveScrollSideCar","getDeltaXY","getTouchXY","tslib_1","require","React","__importStar","react_remove_scroll_bar_1","react_style_singleton_1","aggresiveCapture_1","handleScroll_1","event","changedTouches","clientX","clientY","deltaX","deltaY","extractRef","ref","current","deltaCompare","x","y","generateStyle","id","concat","idCounter","lockStack","props","shouldPreventQueue","useRef","touchStartRef","activeAxis","useState","Style","styleSingleton","lastProps","useEffect","inert","document","body","classList","add","allow_1","__spreadArray","lockRef","shards","map","filter","Boolean","forEach","el","remove","shouldCancelEvent","useCallback","parent","touches","length","allowPinchZoom","touch","touchStart","currentAxis","target","moveDirection","Math","abs","type","canBeScrolledInMainDirection","locationCouldBeScrolled","cancelingAxis","handleScroll","shouldPrevent","_event","delta","sourceEvent","e","name","should","cancelable","preventDefault","shardNodes","node","contains","shouldStop","noIsolation","shouldCancel","push","setTimeout","scrollTouchStart","undefined","scrollWheel","scrollTouchMove","setCallbacks","onScrollCapture","onWheelCapture","onTouchMoveCapture","addEventListener","nonPassive","inst","removeEventListener","removeScrollBar","createElement","Fragment","styles","RemoveScrollBar","gapMode"],"mappings":"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","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.RemoveScrollSideCar = exports.getDeltaXY = exports.getTouchXY = void 0;\nvar tslib_1 = require(\"tslib\");\nvar React = tslib_1.__importStar(require(\"react\"));\nvar react_remove_scroll_bar_1 = require(\"react-remove-scroll-bar\");\nvar react_style_singleton_1 = require(\"react-style-singleton\");\nvar aggresiveCapture_1 = require(\"./aggresiveCapture\");\nvar handleScroll_1 = require(\"./handleScroll\");\nvar getTouchXY = function (event) {\n    return 'changedTouches' in event ? [event.changedTouches[0].clientX, event.changedTouches[0].clientY] : [0, 0];\n};\nexports.getTouchXY = getTouchXY;\nvar getDeltaXY = function (event) { return [event.deltaX, event.deltaY]; };\nexports.getDeltaXY = getDeltaXY;\nvar extractRef = function (ref) {\n    return ref && 'current' in ref ? ref.current : ref;\n};\nvar deltaCompare = function (x, y) { return x[0] === y[0] && x[1] === y[1]; };\nvar generateStyle = function (id) { return \"\\n  .block-interactivity-\".concat(id, \" {pointer-events: none;}\\n  .allow-interactivity-\").concat(id, \" {pointer-events: all;}\\n\"); };\nvar idCounter = 0;\nvar lockStack = [];\nfunction RemoveScrollSideCar(props) {\n    var shouldPreventQueue = React.useRef([]);\n    var touchStartRef = React.useRef([0, 0]);\n    var activeAxis = React.useRef();\n    var id = React.useState(idCounter++)[0];\n    var Style = React.useState(function () { return (0, react_style_singleton_1.styleSingleton)(); })[0];\n    var lastProps = React.useRef(props);\n    React.useEffect(function () {\n        lastProps.current = props;\n    }, [props]);\n    React.useEffect(function () {\n        if (props.inert) {\n            document.body.classList.add(\"block-interactivity-\".concat(id));\n            var allow_1 = tslib_1.__spreadArray([props.lockRef.current], (props.shards || []).map(extractRef), true).filter(Boolean);\n            allow_1.forEach(function (el) { return el.classList.add(\"allow-interactivity-\".concat(id)); });\n            return function () {\n                document.body.classList.remove(\"block-interactivity-\".concat(id));\n                allow_1.forEach(function (el) { return el.classList.remove(\"allow-interactivity-\".concat(id)); });\n            };\n        }\n        return;\n    }, [props.inert, props.lockRef.current, props.shards]);\n    var shouldCancelEvent = React.useCallback(function (event, parent) {\n        if ('touches' in event && event.touches.length === 2) {\n            return !lastProps.current.allowPinchZoom;\n        }\n        var touch = (0, exports.getTouchXY)(event);\n        var touchStart = touchStartRef.current;\n        var deltaX = 'deltaX' in event ? event.deltaX : touchStart[0] - touch[0];\n        var deltaY = 'deltaY' in event ? event.deltaY : touchStart[1] - touch[1];\n        var currentAxis;\n        var target = event.target;\n        var moveDirection = Math.abs(deltaX) > Math.abs(deltaY) ? 'h' : 'v';\n        // allow horizontal touch move on Range inputs. They will not cause any scroll\n        if ('touches' in event && moveDirection === 'h' && target.type === 'range') {\n            return false;\n        }\n        var canBeScrolledInMainDirection = (0, handleScroll_1.locationCouldBeScrolled)(moveDirection, target);\n        if (!canBeScrolledInMainDirection) {\n            return true;\n        }\n        if (canBeScrolledInMainDirection) {\n            currentAxis = moveDirection;\n        }\n        else {\n            currentAxis = moveDirection === 'v' ? 'h' : 'v';\n            canBeScrolledInMainDirection = (0, handleScroll_1.locationCouldBeScrolled)(moveDirection, target);\n            // other axis might be not scrollable\n        }\n        if (!canBeScrolledInMainDirection) {\n            return false;\n        }\n        if (!activeAxis.current && 'changedTouches' in event && (deltaX || deltaY)) {\n            activeAxis.current = currentAxis;\n        }\n        if (!currentAxis) {\n            return true;\n        }\n        var cancelingAxis = activeAxis.current || currentAxis;\n        return (0, handleScroll_1.handleScroll)(cancelingAxis, parent, event, cancelingAxis === 'h' ? deltaX : deltaY, true);\n    }, []);\n    var shouldPrevent = React.useCallback(function (_event) {\n        var event = _event;\n        if (!lockStack.length || lockStack[lockStack.length - 1] !== Style) {\n            // not the last active\n            return;\n        }\n        var delta = 'deltaY' in event ? (0, exports.getDeltaXY)(event) : (0, exports.getTouchXY)(event);\n        var sourceEvent = shouldPreventQueue.current.filter(function (e) { return e.name === event.type && e.target === event.target && deltaCompare(e.delta, delta); })[0];\n        // self event, and should be canceled\n        if (sourceEvent && sourceEvent.should) {\n            if (event.cancelable) {\n                event.preventDefault();\n            }\n            return;\n        }\n        // outside or shard event\n        if (!sourceEvent) {\n            var shardNodes = (lastProps.current.shards || [])\n                .map(extractRef)\n                .filter(Boolean)\n                .filter(function (node) { return node.contains(event.target); });\n            var shouldStop = shardNodes.length > 0 ? shouldCancelEvent(event, shardNodes[0]) : !lastProps.current.noIsolation;\n            if (shouldStop) {\n                if (event.cancelable) {\n                    event.preventDefault();\n                }\n            }\n        }\n    }, []);\n    var shouldCancel = React.useCallback(function (name, delta, target, should) {\n        var event = { name: name, delta: delta, target: target, should: should };\n        shouldPreventQueue.current.push(event);\n        setTimeout(function () {\n            shouldPreventQueue.current = shouldPreventQueue.current.filter(function (e) { return e !== event; });\n        }, 1);\n    }, []);\n    var scrollTouchStart = React.useCallback(function (event) {\n        touchStartRef.current = (0, exports.getTouchXY)(event);\n        activeAxis.current = undefined;\n    }, []);\n    var scrollWheel = React.useCallback(function (event) {\n        shouldCancel(event.type, (0, exports.getDeltaXY)(event), event.target, shouldCancelEvent(event, props.lockRef.current));\n    }, []);\n    var scrollTouchMove = React.useCallback(function (event) {\n        shouldCancel(event.type, (0, exports.getTouchXY)(event), event.target, shouldCancelEvent(event, props.lockRef.current));\n    }, []);\n    React.useEffect(function () {\n        lockStack.push(Style);\n        props.setCallbacks({\n            onScrollCapture: scrollWheel,\n            onWheelCapture: scrollWheel,\n            onTouchMoveCapture: scrollTouchMove,\n        });\n        document.addEventListener('wheel', shouldPrevent, aggresiveCapture_1.nonPassive);\n        document.addEventListener('touchmove', shouldPrevent, aggresiveCapture_1.nonPassive);\n        document.addEventListener('touchstart', scrollTouchStart, aggresiveCapture_1.nonPassive);\n        return function () {\n            lockStack = lockStack.filter(function (inst) { return inst !== Style; });\n            document.removeEventListener('wheel', shouldPrevent, aggresiveCapture_1.nonPassive);\n            document.removeEventListener('touchmove', shouldPrevent, aggresiveCapture_1.nonPassive);\n            document.removeEventListener('touchstart', scrollTouchStart, aggresiveCapture_1.nonPassive);\n        };\n    }, []);\n    var removeScrollBar = props.removeScrollBar, inert = props.inert;\n    return (React.createElement(React.Fragment, null,\n        inert ? React.createElement(Style, { styles: generateStyle(id) }) : null,\n        removeScrollBar ? React.createElement(react_remove_scroll_bar_1.RemoveScrollBar, { gapMode: \"margin\" }) : null));\n}\nexports.RemoveScrollSideCar = RemoveScrollSideCar;\n"]},"metadata":{},"sourceType":"script"}