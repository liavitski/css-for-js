{"ast":null,"code":"var $ijazI$react = require(\"react\");\nvar $ijazI$radixuireactusecallbackref = require(\"@radix-ui/react-use-callback-ref\");\nfunction $parcel$export(e, n, v, s) {\n  Object.defineProperty(e, n, {\n    get: v,\n    set: s,\n    enumerable: true,\n    configurable: true\n  });\n}\n$parcel$export(module.exports, \"useControllableState\", () => $b84d42d44371bff7$export$6f32135080cb4c3);\nfunction $b84d42d44371bff7$export$6f32135080cb4c3({\n  prop: prop,\n  defaultProp: defaultProp,\n  onChange = () => {}\n}) {\n  const [uncontrolledProp, setUncontrolledProp] = $b84d42d44371bff7$var$useUncontrolledState({\n    defaultProp: defaultProp,\n    onChange: onChange\n  });\n  const isControlled = prop !== undefined;\n  const value1 = isControlled ? prop : uncontrolledProp;\n  const handleChange = $ijazI$radixuireactusecallbackref.useCallbackRef(onChange);\n  const setValue = $ijazI$react.useCallback(nextValue => {\n    if (isControlled) {\n      const setter = nextValue;\n      const value = typeof nextValue === 'function' ? setter(prop) : nextValue;\n      if (value !== prop) handleChange(value);\n    } else setUncontrolledProp(nextValue);\n  }, [isControlled, prop, setUncontrolledProp, handleChange]);\n  return [value1, setValue];\n}\nfunction $b84d42d44371bff7$var$useUncontrolledState({\n  defaultProp: defaultProp,\n  onChange: onChange\n}) {\n  const uncontrolledState = $ijazI$react.useState(defaultProp);\n  const [value] = uncontrolledState;\n  const prevValueRef = $ijazI$react.useRef(value);\n  const handleChange = $ijazI$radixuireactusecallbackref.useCallbackRef(onChange);\n  $ijazI$react.useEffect(() => {\n    if (prevValueRef.current !== value) {\n      handleChange(value);\n      prevValueRef.current = value;\n    }\n  }, [value, prevValueRef, handleChange]);\n  return uncontrolledState;\n}","map":{"version":3,"names":["$b84d42d44371bff7$export$6f32135080cb4c3","useControllableState","prop","defaultProp","onChange","uncontrolledProp","setUncontrolledProp","$b84d42d44371bff7$var$useUncontrolledState","isControlled","undefined","value1","handleChange","$ijazI$radixuireactusecallbackref","useCallbackRef","setValue","$ijazI$react","useCallback","nextValue","setter","value","useUncontrolledState","uncontrolledState","useState","prevValueRef","useRef","useEffect","current"],"sources":["packages/react/use-controllable-state/src/index.ts","packages/react/use-controllable-state/src/useControllableState.tsx"],"sourcesContent":["export { useControllableState } from './useControllableState';\n","import * as React from 'react';\nimport { useCallbackRef } from '@radix-ui/react-use-callback-ref';\n\ntype UseControllableStateParams<T> = {\n  prop?: T | undefined;\n  defaultProp?: T | undefined;\n  onChange?: (state: T) => void;\n};\n\ntype SetStateFn<T> = (prevState?: T) => T;\n\nfunction useControllableState<T>({\n  prop,\n  defaultProp,\n  onChange = () => {},\n}: UseControllableStateParams<T>) {\n  const [uncontrolledProp, setUncontrolledProp] = useUncontrolledState({ defaultProp, onChange });\n  const isControlled = prop !== undefined;\n  const value = isControlled ? prop : uncontrolledProp;\n  const handleChange = useCallbackRef(onChange);\n\n  const setValue: React.Dispatch<React.SetStateAction<T | undefined>> = React.useCallback(\n    (nextValue) => {\n      if (isControlled) {\n        const setter = nextValue as SetStateFn<T>;\n        const value = typeof nextValue === 'function' ? setter(prop) : nextValue;\n        if (value !== prop) handleChange(value as T);\n      } else {\n        setUncontrolledProp(nextValue);\n      }\n    },\n    [isControlled, prop, setUncontrolledProp, handleChange]\n  );\n\n  return [value, setValue] as const;\n}\n\nfunction useUncontrolledState<T>({\n  defaultProp,\n  onChange,\n}: Omit<UseControllableStateParams<T>, 'prop'>) {\n  const uncontrolledState = React.useState<T | undefined>(defaultProp);\n  const [value] = uncontrolledState;\n  const prevValueRef = React.useRef(value);\n  const handleChange = useCallbackRef(onChange);\n\n  React.useEffect(() => {\n    if (prevValueRef.current !== value) {\n      handleChange(value as T);\n      prevValueRef.current = value;\n    }\n  }, [value, prevValueRef, handleChange]);\n\n  return uncontrolledState;\n}\n\nexport { useControllableState };\n"],"mappings":";;;;;;;;;;;ACWA,SAASA,wCAATC,CAAiC;EAXjCC,IAAA,EAYEA,IAD+B;EAXjCC,WAAA,EAaEA,WAF+B;EAG/BC,QAAQ,GAAGA,CAAA,KAAM;AAAjB,CAHF,EAIkC;EAChC,MAAM,CAACC,gBAAD,EAAmBC,mBAAnB,IAA0CC,0CAAoB,CAAC;IAhBvEJ,WAAA,EAgByEA,WAAF;IAhBvEC,QAAA,EAgBsFA;GAAhB,CAApE;EACA,MAAMI,YAAY,GAAGN,IAAI,KAAKO,SAA9B;EACA,MAAMC,MAAK,GAAGF,YAAY,GAAGN,IAAH,GAAUG,gBAApC;EACA,MAAMM,YAAY,GAAGC,iCAAA,CAAAC,cAAc,CAACT,QAAD,CAAnC;EAEA,MAAMU,QAA6D,GAAGC,YAAA,CAAAC,WAAA,CACnEC,SAAD,IAAe;IACb,IAAIT,YAAJ,EAAkB;MAChB,MAAMU,MAAM,GAAGD,SAAf;MACA,MAAME,KAAK,GAAG,OAAOF,SAAP,KAAqB,UAArB,GAAkCC,MAAM,CAAChB,IAAD,CAAxC,GAAiDe,SAA/D;MACA,IAAIE,KAAK,KAAKjB,IAAd,EAAoBS,YAAY,CAACQ,KAAD,CAAZ;KAHtB,MAKEb,mBAAmB,CAACW,SAAD,CAAnB;GAPgE,EAUpE,CAACT,YAAD,EAAeN,IAAf,EAAqBI,mBAArB,EAA0CK,YAA1C,CAVoE,CAAtE;EAaA,OAAO,CAACD,MAAD,EAAQI,QAAR,CAAP;;AAGF,SAASP,0CAATa,CAAiC;EArCjCjB,WAAA,EAsCEA,WAD+B;EArCjCC,QAAA,EAuCEA;AAAA,CAFF,EAGgD;EAC9C,MAAMiB,iBAAiB,GAAGN,YAAA,CAAAO,QAAA,CAA8BnB,WAA9B,CAA1B;EACA,MAAM,CAACgB,KAAD,IAAUE,iBAAhB;EACA,MAAME,YAAY,GAAGR,YAAA,CAAAS,MAAA,CAAaL,KAAb,CAArB;EACA,MAAMR,YAAY,GAAGC,iCAAA,CAAAC,cAAc,CAACT,QAAD,CAAnC;EAEAW,YAAA,CAAAU,SAAA,CAAgB,MAAM;IACpB,IAAIF,YAAY,CAACG,OAAb,KAAyBP,KAA7B,EAAoC;MAClCR,YAAY,CAACQ,KAAD,CAAZ;MACAI,YAAY,CAACG,OAAb,GAAuBP,KAAvB;;GAHJ,EAKG,CAACA,KAAD,EAAQI,YAAR,EAAsBZ,YAAtB,CALH,CAKC;EAED,OAAOU,iBAAP"},"metadata":{},"sourceType":"script"}